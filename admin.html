<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å¾Œå°ç®¡ç† - è—¥å“è³‡æ–™</title>
  <style>
    body { font-family: sans-serif; max-width: 900px; margin: auto; padding: 20px; }
    table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    input[type=text], input[type=number] { width: 100%; }
    button { padding: 6px 12px; margin: 2px; }
  </style>
</head>
<body>

<script>
  if (sessionStorage.getItem("adminLoggedIn") !== "true") {
    alert("è«‹å…ˆç™»å…¥");
    window.location.href = "login.html";
  }
</script>

  <h2>ğŸ›  å¾Œå°ç®¡ç†ï¼šè—¥å“è³‡æ–™</h2>

  <table>
    <thead>
      <tr>
        <th>ä»£ç¢¼</th>
        <th>å“å</th>
        <th>è¦æ ¼</th>
        <th>å–®åƒ¹</th>
        <th>ç‹€æ…‹</th>
        <th>æ“ä½œ</th>
      </tr>
    </thead>
    <tbody id="productTable"></tbody>
  </table>

  <h3>æ–°å¢è—¥å“</h3>
  <form id="addForm">
    <input type="text" placeholder="ä»£ç¢¼" id="code" required>
    <input type="text" placeholder="å“å" id="name" required>
    <input type="text" placeholder="è¦æ ¼" id="spec" required>
    <input type="number" placeholder="å–®åƒ¹" id="price" required>
    <input type="text" placeholder="ä¾›æ‡‰ç‹€æ…‹" id="status" value="ä¾›è²¨ä¸­" required>
    <button type="submit">æ–°å¢</button>
  </form>

  <script>
    function loadProducts() {
      const data = localStorage.getItem("products");
      return data ? JSON.parse(data) : [];
    }

    function saveProducts(data) {
      localStorage.setItem("products", JSON.stringify(data));
    }

    let products = loadProducts();
    const table = document.getElementById("productTable");

    function renderTable() {
      table.innerHTML = "";
      products.forEach((p, i) => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td><input value="${p.code}" onchange="update(${i}, 'code', this.value)"></td>
          <td><input value="${p.name}" onchange="update(${i}, 'name', this.value)"></td>
          <td><input value="${p.spec}" onchange="update(${i}, 'spec', this.value)"></td>
          <td><input type="number" value="${p.price}" onchange="update(${i}, 'price', this.value)"></td>
          <td><input value="${p.status}" onchange="update(${i}, 'status', this.value)"></td>
          <td><button onclick="remove(${i})">åˆªé™¤</button></td>
        `;
        table.appendChild(row);
      });
    }

    function update(index, field, value) {
      products[index][field] = field === "price" ? Number(value) : value;
      saveProducts(products);
    }

    function remove(index) {
      if (confirm("ç¢ºå®šè¦åˆªé™¤é€™ç­†è³‡æ–™å—ï¼Ÿ")) {
        products.splice(index, 1);
        saveProducts(products);
        renderTable();
      }
    }

    document.getElementById("addForm").addEventListener("submit", function (e) {
      e.preventDefault();
      const newItem = {
        code: document.getElementById("code").value,
        name: document.getElementById("name").value,
        spec: document.getElementById("spec").value,
        price: Number(document.getElementById("price").value),
        status: document.getElementById("status").value
      };
      products.push(newItem);
      saveProducts(products);
      renderTable();
      this.reset();
    });

    renderTable();
  </script>

</body>
</html>
